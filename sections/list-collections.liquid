{% comment %}
  分类列表页区块
{% endcomment %}

{%- liquid
  assign title = section.settings.title | default: 'COLLECTIONS'
  assign sort = section.settings.sort | default: 'alphabetical'
  assign columns_desktop = section.settings.columns_desktop | default: 3
  assign columns_mobile = section.settings.columns_mobile | default: 1
-%}

<section class="list-collections-section">
  <div class="container">
    <h1 class="page-title">{{ title }}</h1>

    <div class="collections-grid" data-columns-desktop="{{ columns_desktop }}" data-columns-mobile="{{ columns_mobile }}">
      {% for collection in collections %}
        {% unless collection.handle == 'frontpage' %}
          <div class="collection-card">
            <a href="{{ collection.url }}" class="collection-card-link">
              <div class="collection-image-wrapper">
                {% if collection.image %}
                  {{ collection.image | image_url: width: 800 | image_tag:
                    loading: 'lazy',
                    class: 'collection-image',
                    alt: collection.title | escape
                  }}
                {% elsif collection.products.first.featured_image %}
                  {{ collection.products.first.featured_image | image_url: width: 800 | image_tag:
                    loading: 'lazy',
                    class: 'collection-image',
                    alt: collection.title | escape
                  }}
                {% else %}
                  {{ 'collection-1' | placeholder_svg_tag: 'placeholder-svg' }}
                {% endif %}
                
                <div class="collection-overlay">
                  <h2 class="collection-name">{{ collection.title | upcase }}</h2>
                  <p class="collection-count">{{ collection.products_count }} {{ 'collections.general.products' | t }}</p>
                </div>
              </div>
            </a>
          </div>
        {% endunless %}
      {% endfor %}
    </div>
  </div>
</section>

<style>
  .list-collections-section {
    padding: 120px 40px;
    background: #000000;
    min-height: 100vh;
  }

  @media (max-width: 768px) {
    .list-collections-section {
      padding: 100px 20px 60px;
    }
  }

  .collections-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 2px;
    max-width: 1400px;
    margin: 0 auto;
  }

  @media (max-width: 1024px) {
    .collections-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  @media (max-width: 768px) {
    .collections-grid {
      grid-template-columns: 1fr;
      gap: 20px;
    }
  }

  .collection-card-link {
    display: block;
    text-decoration: none;
  }

  .collection-image-wrapper {
    position: relative;
    aspect-ratio: 4/5;
    overflow: hidden;
    background: #111111;
  }

  .collection-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    filter: grayscale(100%) contrast(1.1);
    transition: filter 0.6s cubic-bezier(0.16, 1, 0.3, 1), transform 0.6s cubic-bezier(0.16, 1, 0.3, 1);
  }

  .collection-card:hover .collection-image {
    filter: grayscale(0%) contrast(1);
    transform: scale(1.05);
  }

  .collection-image-wrapper .placeholder-svg {
    width: 100%;
    height: 100%;
    fill: #333333;
  }

  .collection-overlay {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 40px 24px;
    background: linear-gradient(to top, rgba(0, 0, 0, 0.9), transparent);
  }

  .collection-name {
    font-family: 'Inter', sans-serif;
    font-size: 24px;
    font-weight: 700;
    color: #FFFFFF;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin: 0 0 8px;
  }

  .collection-count {
    font-family: 'Inter', sans-serif;
    font-size: 12px;
    color: #888888;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    margin: 0;
  }
</style>

{% schema %}
{
  "name": "List Collections",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Title",
      "default": "COLLECTIONS"
    },
    {
      "type": "select",
      "id": "sort",
      "label": "Sort by",
      "options": [
        {
          "value": "alphabetical",
          "label": "Alphabetical"
        },
        {
          "value": "products_count",
          "label": "Product count"
        },
        {
          "value": "date",
          "label": "Date created"
        }
      ],
      "default": "alphabetical"
    },
    {
      "type": "range",
      "id": "columns_desktop",
      "label": "Desktop columns",
      "min": 2,
      "max": 4,
      "step": 1,
      "default": 3
    },
    {
      "type": "select",
      "id": "columns_mobile",
      "label": "Mobile columns",
      "options": [
        {
          "value": "1",
          "label": "1"
        },
        {
          "value": "2",
          "label": "2"
        }
      ],
      "default": "1"
    }
  ]
}
{% endschema %}
